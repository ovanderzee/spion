{"version":3,"file":"createSpion.js","sources":["../src/index.ts"],"sourcesContent":["import { CallInfo, Spion } from './types'\n\nconst clone = function (original: Function, context: object): Function {\n    // clone function, see https://stackoverflow.com/a/62767649\n\n    // Creates a new function, optionally preserving desired context.\n    const bound = original.bind(context)\n    // Shallow copies over function properties, if any.\n    const replica = Object.assign(bound, original)\n    return replica\n}\n\nconst createSpion = function (\n    api: any,\n    functionName: string,\n    context?: any,\n): Spion {\n    const original: Function = api[functionName]\n    const replica = clone(original, context)\n    const callData: CallInfo[] = []\n\n    const tracker = function () {\n        const currentCallInfo: CallInfo = {\n            args: Array.from(arguments),\n            return: replica(...arguments),\n        }\n        callData.push(currentCallInfo)\n        return currentCallInfo.return\n    }\n\n    api[functionName] = tracker\n\n    const report = function (): CallInfo[] {\n        api[functionName] = original\n        return callData\n    }\n\n    return {\n        report: report,\n    }\n}\n\nexport default createSpion\n"],"names":[],"mappings":"AAEA,MAAM,KAAA,GAAQ,SAAU,QAAA,EAAoB,OAA2B,EAAA;AAInE,EAAM,MAAA,KAAA,GAAQ,QAAS,CAAA,IAAA,CAAK,OAAO,CAAA,CAAA;AAEnC,EAAA,MAAM,OAAU,GAAA,MAAA,CAAO,MAAO,CAAA,KAAA,EAAO,QAAQ,CAAA,CAAA;AAC7C,EAAO,OAAA,OAAA,CAAA;AACX,CAAA,CAAA;AAEA,MAAM,WAAc,GAAA,SAChB,GACA,EAAA,YAAA,EACA,OACK,EAAA;AACL,EAAM,MAAA,QAAA,GAAqB,IAAI,YAAY,CAAA,CAAA;AAC3C,EAAM,MAAA,OAAA,GAAU,KAAM,CAAA,QAAA,EAAU,OAAO,CAAA,CAAA;AACvC,EAAA,MAAM,WAAuB,EAAC,CAAA;AAE9B,EAAA,MAAM,UAAU,WAAY;AACxB,IAAA,MAAM,eAA4B,GAAA;AAAA,MAC9B,IAAA,EAAM,KAAM,CAAA,IAAA,CAAK,SAAS,CAAA;AAAA,MAC1B,MAAA,EAAQ,OAAQ,CAAA,GAAG,SAAS,CAAA;AAAA,KAChC,CAAA;AACA,IAAA,QAAA,CAAS,KAAK,eAAe,CAAA,CAAA;AAC7B,IAAA,OAAO,eAAgB,CAAA,MAAA,CAAA;AAAA,GAC3B,CAAA;AAEA,EAAA,GAAA,CAAI,YAAY,CAAI,GAAA,OAAA,CAAA;AAEpB,EAAA,MAAM,SAAS,WAAwB;AACnC,IAAA,GAAA,CAAI,YAAY,CAAI,GAAA,QAAA,CAAA;AACpB,IAAO,OAAA,QAAA,CAAA;AAAA,GACX,CAAA;AAEA,EAAO,OAAA;AAAA,IACH,MAAA;AAAA,GACJ,CAAA;AACJ;;;;"}